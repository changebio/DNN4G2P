# Applying deep learning to predict phenotype based on genetic variation

Inspired by the success of deep neural networks (DNN), I explored the potential of using DNN in learning phenotype and genotype associations. A well-characterized data set of heterogeneous stock rats ([Baud, et al](https://www.ncbi.nlm.nih.gov/pubmed/?term=23708188)) that contained 1407 individuals and many phenotypes. We choose to focus on coat color because it has the most complete data and has a strong QTL located on chr 1. We used the Keras library (ver 2.0.2)  with the Theano backend (v 0.9.0) to train DNNs on the 46,943 chr 1 SNPs.  A GPU (GeForce GTX 1070, 8 GB) running CUDA (8.0.61) was used to accelerate calculation.  A simple neural network with one hidden layer of 200 neurons achieved an accuracy of 99.24% in predicting coat colors after 100 training epochs. Accuracy was reduced to 60.23% when new samples were tested, indicating model overfitting. Using five hidden layers increased test accuracy slightly to 61.93%. Further increasing the depth of the network reduced test accuracy. Adding dropout layers did not improve test accuracy. However, augmenting samples by swapping 20% of SNPs and then adding these swapped samples to the training set increased test accuracy to 63.07%. Test accuracy remained at 60.8% when the augmented samples were trained on a network with five hidden layers. In contrast to chr 1, the test accuracy was approximately 20% when these networks were trained on chr 2 data, which had no QTL for the phenotype. In summary, our data showed that DNN can learn genotype-phenotype associations directly from the raw genotype data. Further performance improvement likely will require much larger training data set. 

